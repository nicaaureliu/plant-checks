<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Plant Checks</title>

  <style>
    :root{
      --border:#111;
      --soft:#ddd;
      --pill:#f3f3f3;
      --yellow:#ffd600;
    }
    body { font-family: Arial, sans-serif; margin: 0; padding: 14px; background:#fff; color:#111; }
    .small { font-size: 12px; color: #666; }
    .card { border: 1px solid #ddd; border-radius: 10px; padding: 12px; margin-bottom: 12px; background:#fff; }

    .buildTag { font-size:12px; color:#666; margin-bottom:8px; }

    /* Sheet-like header */
    .sheetHeader{
      display:grid;
      grid-template-columns: 1fr auto 1fr;
      align-items:center;
      gap:10px;
    }
    .logoLeft { width: 140px; height:auto; justify-self:start; }
    .logoRight { width: 52px; height:auto; justify-self:end; }
    .ref { font-size: 18px; font-weight:700; justify-self:center; }

    .sheetTitle { text-align:center; font-size: 16px; font-weight:700; margin: 8px 0 0; }

    .metaRow{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      margin-top:10px;
      font-size: 12px;
    }
    .metaRow b { font-weight:700; }

    .yellowBar{
      margin-top:10px;
      background:var(--yellow);
      padding:8px 10px;
      font-weight:700;
      font-size: 12px;
      text-align:center;
      border-top:1px solid var(--border);
      border-bottom:1px solid var(--border);
    }

    /* Inputs */
    label { font-size: 12px; color: #444; display:block; margin-bottom:6px; }
    input, textarea, select, button {
      width: 100%;
      padding: 10px;
      border-radius: 10px;
      border: 1px solid #ccc;
      box-sizing: border-box;
      font-family: inherit;
      font-size: 14px;
      background:#fff;
    }
    textarea { min-height: 70px; }

    .grid2 { display:grid; grid-template-columns: 1fr 1fr; gap:10px; }
    .topBtns { display:grid; grid-template-columns: 1fr 1fr 1fr; gap:10px; align-items:center; }
    .pill { background:var(--pill); border:1px solid var(--soft); color:#111; font-weight:700; cursor:pointer; }
    .pill.active { background:#111; color:#fff; border-color:#111; }
    .pill:disabled { opacity:0.6; cursor:not-allowed; }

    /* Checks */
    .checksHeaderRow{
      display:flex;
      justify-content:space-between;
      align-items:flex-end;
      gap:10px;
      flex-wrap:wrap;
    }

    /* Desktop table */
    .tableWrap { overflow-x:auto; border:1px solid var(--border); border-radius:8px; }
    table { border-collapse: collapse; width: 100%; min-width: 980px; background:#fff; }
    th, td { border:1px solid var(--border); padding:6px; font-size:12px; }
    th.item { width: 520px; background:var(--yellow); }
    td.item { font-size:11px; }
    td.day { text-align:center; width: 66px; }

    /* The little rounded "pill" inside each day cell */
    .markBtn{
      width: 44px;
      height: 22px;
      padding:0;
      border-radius: 7px;
      border: 1px solid #cfcfcf;
      background:#fff;
      font-weight: 900;
      cursor:pointer;
      line-height: 22px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      user-select:none;
    }
    .markBtn.disabled{
      opacity:0.25;
      cursor:not-allowed;
    }

    /* Mobile checks list */
    .mobileOnly { display:none; }
    .mobileRow{
      display:grid;
      grid-template-columns: 1fr 80px;
      gap:10px;
      align-items:center;
      border:1px solid #eee;
      border-radius:10px;
      padding:10px;
      margin-bottom:10px;
    }
    .mobileLabel{ font-size:13px; }
    .mobileBtn{
      width:80px;
      height:44px;
      border-radius:12px;
      border:1px solid #cfcfcf;
      background:#fff;
      font-size:18px;
      font-weight:900;
      cursor:pointer;
    }

    /* Signature */
    canvas { width: 100%; height: 140px; border: 1px solid #ccc; border-radius: 10px; touch-action: none; background:#fff; }
    .btnRow { display:grid; grid-template-columns: 1fr 1fr; gap:10px; margin-top:10px; }
    .submitBtn { border:0; background:#111; color:#fff; font-weight:800; padding: 12px; border-radius: 10px; cursor:pointer; }
    .submitBtn:disabled { opacity:0.6; cursor:not-allowed; }

    /* responsive */
    @media (max-width: 760px){
      body{ padding:10px; }
      .logoLeft{ width: 130px; }
      .logoRight{ width: 48px; }
      .grid2{ grid-template-columns: 1fr; }
      .tableWrap{ display:none; }
      .mobileOnly{ display:block; }
    }
  </style>

  <!-- jsPDF -->
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
</head>

<body>
  <div class="buildTag" id="buildTag">BUILD: —</div>

  <div class="card">
    <div class="sheetHeader">
      <img class="logoLeft" src="assets/atl-logo.png" alt="Active Tunnelling">
      <div class="ref" id="formRef">QPFPL5.2</div>
      <img class="logoRight" src="assets/tp.png" alt="TP">
    </div>

    <div class="sheetTitle" id="sheetTitle">Excavator Pre-Use Inspection Checklist</div>

    <div class="metaRow">
      <div><b>Machine No:</b> <span id="machineNoPreview">—</span></div>
      <div style="text-align:right;"><b>Week commencing:</b> <span id="weekCommencingPreview">—</span></div>
    </div>

    <div class="yellowBar">
      All checks must be carried out in line with Specific Manufacturer’s instructions
    </div>

    <div style="margin-top:12px;">
      <div class="topBtns">
        <button class="pill" id="btnExc" type="button">Excavator</button>
        <button class="pill" id="btnCrane" type="button">Crane</button>
        <button class="pill" id="btnDump" type="button">Dumper</button>
      </div>
      <p class="small" id="selectedType" style="margin:10px 0 0;">Selected: —</p>
    </div>
  </div>

  <div class="card">
    <div class="grid2">
      <div>
        <label>Site</label>
        <input id="site" placeholder="e.g. Hinckley" />
      </div>
      <div>
        <label>Date</label>
        <input id="date" type="date" />
      </div>
    </div>

    <div class="grid2" style="margin-top:10px;">
      <div>
        <label>Machine / Plant ID</label>
        <input id="plantId" placeholder="e.g. EXC-12 / AB12CDE" />
      </div>
      <div>
        <label>Operator name</label>
        <input id="operator" placeholder="Name" />
      </div>
    </div>

    <div style="margin-top:10px;">
      <label>Hours / Shift</label>
      <input id="hours" placeholder="e.g. 06:00–18:00" />
    </div>
  </div>

  <div class="card">
    <div class="checksHeaderRow">
      <h3 style="margin:0;">Checks (Mon–Sun)</h3>
      <span class="small">Only the selected day is editable (✓ / X / N/A).</span>
    </div>

    <!-- Desktop -->
    <div class="tableWrap" style="margin-top:10px;">
      <table>
        <thead>
          <tr>
            <th class="item"> </th>
            <th>Mon</th><th>Tue</th><th>Wed</th><th>Thu</th><th>Fri</th><th>Sat</th><th>Sun</th>
          </tr>
        </thead>
        <tbody id="checksBody"></tbody>
      </table>
    </div>

    <!-- Mobile -->
    <div class="mobileOnly" style="margin-top:10px;">
      <p class="small" style="margin-top:0;">Mobile mode: tap the big button to cycle ✓ / X / N/A.</p>
      <div id="mobileChecks"></div>
    </div>
  </div>

  <div class="card">
    <div>
      <label>Defects identified</label>
      <textarea id="defectsText" placeholder="Write defects (if any)"></textarea>
    </div>

    <div class="grid2" style="margin-top:10px;">
      <div>
        <label>Reported to (select)</label>
        <select id="reportedTo"></select>
      </div>
      <div>
        <label>Action taken</label>
        <textarea id="actionTaken" placeholder="What action was taken"></textarea>
      </div>
    </div>
  </div>

  <div class="card">
    <h3 style="margin-top:0;">Signature</h3>
    <canvas id="sig"></canvas>
    <div class="btnRow">
      <button class="pill" id="clearSig" type="button">Clear</button>
      <button class="pill" id="fillToday" type="button">Today</button>
    </div>
  </div>

  <div class="card">
    <button id="submitBtn" class="submitBtn" type="button">Submit (email PDF)</button>
    <p class="small" id="status">Ready.</p>
  </div>

  <script src="app.js"></script>
</body>
</html>
